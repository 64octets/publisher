<div class="row-fluid">
  <div class="span12">

    <div class="page-header">
      <h1>Publications dashboard</h1>
    </div>

    <div class="row-fluid">

      <div class="span2">

        <div class="well sidebar-nav">
          <ul class="nav nav-list">

            <!-- <li class="nav-header">Filter by Context</li>
            <li><a href="#" rel="popover" data-content="Not implemented yet" data-original-title="Soon!">Biz</a></li>
            <li class="active"><a href="#">Citizen</a></li>

            <li class="nav-header">Filter by Format</li>
            <li><a href="#">Quick Answers <span class="label pull-right">7</span></a></li>
            <li><a href="#">Guides <span class="label pull-right">29</span></a></li>
            <li><a href="#">Transactions <span class="label pull-right">38</span></a></li>
            <li><a href="#">Local Transactions <span class="label pull-right">3</span></a></li>
            <li><a href="#">Smart Answers <span class="label pull-right">4</span></a></li> -->

            <li class="nav-header">Filter by Status</li>
            <%= publication_tab_list 'Lined up', 'Drafts', 'In review', 'Amends needed', 'Out for fact check', 'Fact check received', 'Ready', 'Published', 'Archived' %>
          </ul>

        </div><!--/.well -->

        <form method="GET" action="/admin">
          <label for="user-filter" class="visuallyhidden">Filter by user</label>
          <%=
            select_tag("filter", options_for_select(
              [["All", "all"], ["Nobody", "nobody"]] +
              User.alphabetized.map{ |u| [u.name, u.uid] }, @filter
            ), id: "user-filter", :class => "span2")
          %>
          <input class="btn btn-primary" type="submit" value="Filter">
        </form>

      </div>

      <div id="publication-list-container" class="span10">

        <h2>&ldquo;Lined-up&rdquo; publications</h2>

        <table class="table table-striped table-condensed" summary="List of &ldquo;Lined Up&rdquo; content">
          <thead>
            <tr>
              <th scope="col">Format</th>
              <th scope="col">Biz?</th>
              <th scope="col" class="title">Title</th>
              <th scope="col">Video</th>
              <th scope="col" class="datetime">Last updated</th>
              <th scope="col">Assigned to</th>
              <th scope="col">Section</th>
              <th scope="col">Reviews</th>
              <th scope="col" class="nosort">Start work</th>
              <th scope="col" class="nosort">Preview</th>
            </tr>
          </thead>
          <tbody>
            <%= render :collection => @presenter.lined_up, :partial => 'publication', :locals => {:tab => :lined_up} %>
          </tbody>
        </table>

      </div><!--./span10 -->

    </div><!--./row-fluid -->
  </div><!--./span12 -->
</div><!--./row-fluid -->

<% content_for :page_title, "Publications" %>
<% content_for :extra_javascript do%>
  <script type="text/javascript" charset="utf-8">
  $(function () {
    $('.status-option a').click(function () {
      $('#publication-list-container').load($(this).attr('href'));
      $(this).closest('ul').find('li').removeClass('active');
      $(this).closest('li').addClass('active');
      return false;
    });
  });
  </script>
<% end %>