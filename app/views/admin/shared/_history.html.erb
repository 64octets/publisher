<%= semantic_form_for(:note, :url=> admin_notes_path) do |f| %>
  <%= f.inputs do %>
    <%= hidden_field_tag :publication_id, publication.id %>
    <%= f.input :comment, :label => 'Note', :as => :text, :input_html => { :rows => 3 }, :hint => 'Don&rsquo;t forget to save your note when you have finished!' %>
  <% end %>
  <%= f.buttons do %>
    <li><input class="update" name="commit" type="submit" value="Save Note"></li>
  <% end %>
<% end %>

<hr >

<% publication.editions.reverse.each do |edition| %>
  <div class="edition">
    <div class="buttons group">
      <h3>Version <%= edition.version_number %></h3>
    </div>
    <ul class="history">
      <% edition.actions.reverse.each do |action| %>
      <li class="<%= action.request_type.parameterize %> group">
        <div class="action-time">
          <p><span class="visuallyhidden">Version created on</span> <span class="time"><%= action.created_at.strftime("%d/%m/%Y") %></span> <span class="visuallyhidden">at</span> <%= action.created_at.strftime("%R") %></p>
        </div>

        <div>
          <p><span class="action-by"><%= action.to_s %></span> by
          <% if action.requester %>
            <%= mail_to action.requester.email, action.requester.name %></p>
          <% else %>
            Gov.UK Bot
          <% end %>
        </div>

        <div class="action-comment">
          <% if action.requester %>
            <%= image_tag action.requester.gravatar_url, :alt => action.requester.to_s %>
          <% end %>
          <% if action.comment.present? %>
          <blockquote>
            <span><%= simple_format action.comment %></span>
          </blockquote>
          <% end %>
        </div>
      </li>
      <% end %>
    </ul>
  </div>
<% end %>
